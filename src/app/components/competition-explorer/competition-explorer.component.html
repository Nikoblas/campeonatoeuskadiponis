<div class="container">
  <div class="header">
    <div class="header-left">
      <button class="back-btn" routerLink="/">
        <i class="fas fa-arrow-left"></i>
        {{ 'explorer.backToSummary' | translate }}
      </button>
    </div>
    <div class="header-center">
      <h1>{{ 'explorer.title' | translate }}</h1>
    </div>
    <div class="header-right">
      <button class="admin-btn" routerLink="/admin/login">
        <i class="fas fa-lock"></i>
        {{ 'explorer.adminPanel' | translate }}
      </button>
    </div>
  </div>

  <div class="content">
    <div class="filters">
      <!-- Sede Ãºnica: se elimina selector de concurso/sede -->

      <div class="filter-group">
        <label for="dia">{{ 'common.labels.day' | translate }}:</label>
        <select id="dia" [(ngModel)]="diaSeleccionado" (change)="cargarDatos()">
          <option *ngFor="let dia of dias" [value]="dia">{{dia}}</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="categoria">{{ 'common.labels.category' | translate }}:</label>
        <select id="categoria" [(ngModel)]="categoriaSeleccionada" (change)="cargarDatos()">
          <option *ngFor="let categoria of categorias" [value]="categoria">{{getCategoriaVisual(categoria)}}</option>
        </select>
      </div>
    </div>

    <div class="results">
      <div class="results-header">
        <h2>{{ 'explorer.results' | translate }} {{ concursoSeleccionado }} - {{ diaSeleccionado }} - {{ getCategoriaVisual(categoriaSeleccionada) }}</h2>
        <button class="download-btn" (click)="descargarExcel()" [disabled]="datos.length === 0">
          <i class="fas fa-download"></i>
          {{ 'competitionTable.table.downloadExcel' | translate }}
        </button>
      </div>
      <table class="results-table">
        <thead>
          <tr>
            <th *ngFor="let columna of columnasPrincipales">{{columna}}</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let fila of datos" (click)="onSeleccionarFila(fila)">
            <td *ngFor="let columna of columnasPrincipales">{{fila[columna]}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- Popup de detalles -->
  <div class="popup-overlay" *ngIf="mostrarPopup" (click)="cerrarPopup()">
    <div class="popup-content" (click)="$event.stopPropagation()">
      <button class="close-btn" (click)="cerrarPopup()">
        <i class="fas fa-times"></i>
      </button>
      <h2>{{ 'explorer.details.title' | translate }}</h2>
      <div class="popup-details" *ngIf="filaSeleccionada">
        <div *ngFor="let columna of columnasPrincipales" class="detail-row">
          <span class="detail-label">{{columna}}:</span>
          <span class="detail-value">{{filaSeleccionada[columna]}}</span>
        </div>
      </div>
    </div>
  </div>
</div>
